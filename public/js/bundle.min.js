const copyBtn=document.getElementById("copy-button"),copyTxt=document.getElementById("copy-text");copyBtn&&copyTxt&&copyBtn.addEventListener("click",()=>{copyTxt.focus(),copyTxt.select();try{const msg=document.execCommand("copy")?"successful":"unsuccessful";console.log("Copying text command was "+msg),copyBtn.innerHTML="Copied URL"}catch(err){console.log("Oops, unable to copy"),copyBtn.innerHTML="Please retry"}});const firebaseConfig={apiKey:"AIzaSyDnBaT31_LbWAjiRd7isQ1pPdiDVD1HmtQ",authDomain:"combinify-b1222.firebaseapp.com",databaseURL:"combinify-b1222-default-rtdb.europe-west1.firebasedatabase.app",projectId:"combinify-b1222",storageBucket:"combinify-b1222.appspot.com",messagingSenderId:"274350746286",appId:"1:274350746286:web:ee843bfbd1f420cb235b3f",measurementId:"G-1PDBZFE48J"};firebase.initializeApp(firebaseConfig);const deleteBtn=document.querySelectorAll(".delete"),playlist=document.querySelector(".playlist-name"),songContainer=document.querySelector(".songs"),songListEl=document.querySelector(".song-lists"),personEl=document.querySelectorAll(".person");if(playlist){const afterHashtag=/#([\w\d]+)/.exec(playlist.innerHTML)[1],beforeHashtag=/([\w\d\s]+)#/.exec(playlist.innerHTML)[1],songsId=songContainer.classList[1],playlistRef=firebase.database().ref("playlists/"+beforeHashtag);personEl.forEach(person=>{setSelected(person,songsId),person.addEventListener("click",e=>{const personId=person.classList[[person.classList.length-1]],songsRef=playlistRef.child("/songs/");if(person.classList.contains("selected"))return;songListEl.innerHTML="";const containerOfSongs=document.createElement("section");containerOfSongs.classList.add("songs"),containerOfSongs.classList.add(""+personId),playlistRef.get().then(snap=>{snap.val().searchKey===afterHashtag&&songsRef.get().then(snap=>{Object.keys(snap.val()).forEach(key=>{key===personId&&(console.log(),snap.val()[""+key].forEach(song=>{const artistContainer=document.createElement("section"),songEl=document.createElement("div"),artistEl=document.createElement("p"),nameEl=document.createElement("p");artistEl.classList.add("songArtist"),nameEl.classList.add("songName"),artistEl.innerHTML=""+song.songArtist,nameEl.innerHTML=""+song.songName,songEl.appendChild(nameEl),songEl.appendChild(artistEl),artistContainer.appendChild(songEl),containerOfSongs.appendChild(artistContainer)}))})})}).catch(err=>console.warn("playlistRefErr",err)),songListEl.appendChild(containerOfSongs),changeSelected(person,personId)})}),playlistRef.get().then(snap=>{snap.val().searchKey===afterHashtag&&deleteBtn.forEach(btn=>{btn.addEventListener("click",e=>{let songEl=e.currentTarget.previousSibling.previousSibling.childNodes,songArtist=songEl[1].innerHTML,songName=songEl[3].innerHTML;const songsRef=playlistRef.child("/songs/"+songContainer.classList[1]);e.currentTarget.parentElement.innerHTML="",songsRef.get().then(snap=>{snap.forEach(snapshot=>{snapshot.val().songArtist===songArtist&&snapshot.val().songName===songName&&songsRef.orderByChild("uri").equalTo(snapshot.val().uri).once("value").then(snapshot=>{snapshot.forEach(child=>{child.ref.remove().then(()=>"Removed song").catch(err=>console.warn("songErr",err))})}).then(()=>"Removed song").catch(err=>console.warn("songRefErr",err))})}).catch(err=>console.warn("playlistRefErr",err))})})}).catch(err=>console.warn(err))}function changeSelected(person){let classes=[];person.classList.forEach(cssClass=>{document.querySelector(".selected").classList.remove("selected"),classes.push(cssClass),classes.unshift("selected"),classes.forEach(separateClass=>{person.classList.add(separateClass)})})}function setSelected(person,songsId){let classes=[];person.classList.forEach(cssClass=>{classes.push(cssClass),cssClass===songsId&&(person.removeAttribute("class"),person.classList.add("selected"),classes.forEach(separateClass=>{person.classList.add(separateClass)}))})}const socket=io(),peopleEl=document.querySelector(".people");window.addEventListener("load",()=>{window.location.pathname.startsWith("/playlists")&&(socket.on("connect",()=>{console.log("connected")}),socket.on("update users",playlist=>{updateUsers(playlist)}))});const updateUsers=playlist=>{peopleEl.innerHTML="",Object.values(playlist.activeUsers).forEach(user=>{const personEl=document.createElement("section");if(personEl.classList.add("person"),user.id===playlist.host){personEl.classList.add("host");const hostTag=document.createElement("div");hostTag.classList.add("host-tag"),personEl.appendChild(hostTag)}const imgEl=document.createElement("img");imgEl.src=user.image;const nameEl=document.createElement("h2"),nameText=document.createTextNode(user.name);nameEl.classList.add("name"),nameEl.appendChild(nameText),personEl.appendChild(imgEl),personEl.appendChild(nameEl),peopleEl.appendChild(personEl)})};